<div class="h-screen bg-gray-50 overflow-y-auto">
  <!-- Header Section -->
  <div class="sticky top-0 z-10 bg-white px-4 py-2 shadow-sm">
    <div class="flex items-center justify-between mb-2">
      <div class="flex items-center space-x-2">
        <div class="w-6 h-6 bg-black rounded-full flex items-center justify-center">
          <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
            <path
              fill-rule="evenodd"
              d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </div>
        <span class="text-black font-medium text-sm">Halo, {{ currentUser }}!</span>
      </div>
      <div class="text-right">
        <span class="text-black text-xs">{{ currentTime }}</span>
      </div>
    </div>
  </div>

  <!-- Weekly Stats Cards -->
  <div class="px-6 py-4">
    <div class="flex space-x-4">
      <!-- On Time Card -->
      <div class="bg-white border-2 border-[#7D2E2E] rounded-lg p-4 flex-1 text-center">
        <div class="text-3xl font-bold text-[#7D2E2E] mb-1">{{ weeklyStats.onTime }}</div>
        <div class="text-sm text-[#7D2E2E]">Tepat Waktu</div>
      </div>

      <!-- Late Card -->
      <div class="bg-white border-2 border-[#7D2E2E] rounded-lg p-4 flex-1 text-center">
        <div class="text-3xl font-bold text-[#7D2E2E] mb-1">{{ weeklyStats.late }}</div>
        <div class="text-sm text-[#7D2E2E]">Terlambat</div>
      </div>

      <!-- Absent Card -->
      <div class="bg-white border-2 border-[#7D2E2E] rounded-lg p-4 flex-1 text-center">
        <div class="text-3xl font-bold text-[#7D2E2E] mb-1">{{ weeklyStats.absent }}</div>
        <div class="text-sm text-[#7D2E2E]">Tidak Absen</div>
      </div>
    </div>
  </div>

  <!-- Overall Attendance Chart -->
  <div class="px-6 py-4">
    <div class="bg-[#7D2E2E] rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-white text-lg font-medium">Absensi Keseluruhan</h3>
        <select
          [(ngModel)]="selectedPeriod"
          (change)="onPeriodChange($event)"
          class="bg-[#7D2E2E] text-white text-sm border-none outline-none"
        >
          <option value="Bulanan">Bulanan</option>
          <option value="Mingguan">Mingguan</option>
          <option value="Harian">Harian</option>
        </select>
      </div>

      <div class="flex items-center justify-between">
        <!-- Donut Chart Area -->
        <div class="flex-1 flex items-center justify-center">
          <div class="relative w-32 h-32">
            <!-- Donut Chart SVG -->
            <svg class="w-32 h-32 transform -rotate-90" viewBox="0 0 100 100">
              <!-- Background circle -->
              <circle
                cx="50"
                cy="50"
                r="40"
                fill="none"
                stroke="rgba(255,255,255,0.2)"
                stroke-width="8"
              ></circle>
              <!-- Present segment (green) -->
              <circle
                cx="50"
                cy="50"
                r="40"
                fill="none"
                stroke="#22c55e"
                stroke-width="8"
                stroke-dasharray="220"
                stroke-dashoffset="66"
                stroke-linecap="round"
              ></circle>
              <!-- Late segment (orange) -->
              <circle
                cx="50"
                cy="50"
                r="40"
                fill="none"
                stroke="#f97316"
                stroke-width="8"
                stroke-dasharray="220"
                stroke-dashoffset="110"
                stroke-linecap="round"
              ></circle>
              <!-- Absent segment (pink) -->
              <circle
                cx="50"
                cy="50"
                r="40"
                fill="none"
                stroke="#ec4899"
                stroke-width="8"
                stroke-dasharray="220"
                stroke-dashoffset="132"
                stroke-linecap="round"
              ></circle>
            </svg>

            <!-- Center text -->
            <div class="absolute inset-0 flex flex-col items-center justify-center">
              <div class="text-white text-2xl font-bold">{{ overallAttendance.percentage }}%</div>
              <div class="text-white text-sm">Hadir</div>
            </div>
          </div>
        </div>

        <!-- Legend -->
        <div class="flex-1 ml-6">
          <div class="space-y-3">
            <div class="flex items-center space-x-3">
              <div class="w-4 h-4 bg-green-500 rounded-full"></div>
              <span class="text-white text-sm">Hadir</span>
            </div>
            <div class="flex items-center space-x-3">
              <div class="w-4 h-4 bg-orange-500 rounded-full"></div>
              <span class="text-white text-sm">Terlambat</span>
            </div>
            <div class="flex items-center space-x-3">
              <div class="w-4 h-4 bg-pink-500 rounded-full"></div>
              <span class="text-white text-sm">Tidak Absen</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Monthly Chart -->
  <div class="px-6 py-4">
    <div class="bg-white rounded-lg p-6 border-2 border-[#7D2E2E]">
      <!-- Tabs -->
      <div class="flex space-x-1 mb-6 bg-gray-100 rounded-lg p-1">
        <button
          (click)="onTabChange('Harian')"
          [class]="activeTab === 'Harian' ? 'bg-[#7D2E2E] text-white' : 'text-gray-600'"
          class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors"
        >
          Harian
        </button>
        <button
          (click)="onTabChange('Mingguan')"
          [class]="activeTab === 'Mingguan' ? 'bg-[#7D2E2E] text-white' : 'text-gray-600'"
          class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors"
        >
          Mingguan
        </button>
        <button
          (click)="onTabChange('Bulanan')"
          [class]="activeTab === 'Bulanan' ? 'bg-[#7D2E2E] text-white' : 'text-gray-600'"
          class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors"
        >
          Bulanan
        </button>
      </div>

      <!-- Bar Chart -->
      <div class="h-48 flex items-end justify-between space-x-2">
        <div *ngFor="let data of monthlyData" class="flex-1 flex flex-col items-center">
          <div class="text-xs text-gray-600 mb-2">{{ data.percentage }}%</div>
          <div
            [class]="getBarColor(data.color)"
            [style.height]="getBarHeight(data.percentage)"
            class="w-full rounded-t-sm mb-2"
          ></div>
          <div class="text-xs text-gray-600">{{ data.month }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <app-student-bottom-navigation
    [activePage]="activePage"
    (navigateToDashboard)="onNavigateToDashboard()"
    (navigateToHistory)="onNavigateToHistory()"
    (openQRScanner)="onOpenQRScanner()"
    (navigateToProfile)="onNavigateToProfile()"
    (logout)="onLogout()"
  ></app-student-bottom-navigation>

  <!-- Additional content to ensure scrollability -->
  <div class="px-6 py-4">
    <div class="bg-white rounded-lg p-6 border-2 border-[#7D2E2E]">
      <h3 class="text-[#7D2E2E] text-lg font-bold mb-4">Informasi Tambahan</h3>
      <div class="space-y-3 text-gray-600">
        <p>• Pastikan untuk melakukan absensi tepat waktu</p>
        <p>• QR Code akan aktif sesuai jadwal yang ditentukan</p>
        <p>• Riwayat absensi dapat dilihat di menu Riwayat</p>
        <p>• Hubungi admin jika mengalami kendala</p>
      </div>
    </div>
  </div>

  <!-- Add bottom padding to prevent content from being hidden behind navigation -->
  <div class="h-16"></div>
</div>
